<div class="mod-tab-items">
    <div class="mod-tab-item primary-item">
        <strong>Sort By: </strong>

        <select ng-model="sort.reviews" ng-init="sort.reviews = 'reputation'">
            <option value="reputation">Reputation</option>
            <option value="helpfulness">Helpfulness</option>
            <option value="overallRating">Overall Rating</option>
            <option value="submitted">Date Submitted</option>
            <option value="edited">Last Edited</option>
        </select>
    </div>

    <div class="quality-item">
        <span class="quality-number" title="Average Rating">{{mod.average_rating | number:0}}/100</span>
        AVG RATING
    </div>

    <div class="mod-tab-item">
        <input class="btn" type="button" value="Add Review" ng-click="startNewReview()" ng-disabled="newReview"/>
    </div>
</div>

<div class="content-block add-note-box" ng-show="newReview">
    <div class="content-title">
        Add Review
        ({{newReview.overallRating}}/100)
    </div>
    <div class="ratings-container">
        <div class="rating-item" ng-repeat="rating in newReview.ratings">
            <div>
                <select class="select" ng-options="section as section.name for section in availableSections.concat([rating.section]) track by section.id" ng-model="rating.section" ng-change="changeSection(rating.section, '{{rating.section.id}}')" pu-elastic-input>
                </select>:
                <i class="fa fa-caret-down" aria-hidden="true"></i>
            </div>
            <input ng-change="rating.rating = formatScore(rating.rating); updateOverallRating()" ng-model="rating.rating" ng-click="focusText($event)" pu-elastic-input>
        </div>
        <div class="section-tools">
            <i class="fa fa-plus" aria-hidden="true" ng-class="{ 'disabled' : newReview.ratings.length >= 5 || availableSections.length == 0 }" ng-click="addNewRating()" title="{{ newReview.ratings.length >= 5 || availableSections.length == 0 ? 'Maximum review sections reached.  You can\'t add any more!' : 'Add review section' }}"></i>
            <i class="fa fa-minus" aria-hidden="true" ng-class="{ 'disabled' : newReview.ratings.length <= 1}" ng-click="removeRating()" title="{{newReview.ratings.length <= 1 ? 'Minimum review sections reached.  You can\'t remove any more!' : 'Remove review section'}}"></i>
        </div>
    </div>
    <div class="content-container">
        <text-area class="note-text-area" data="newReview.text_body" ng-refresh="updateMDE" on-change="validateReview"></text-area>

        <div class="action-button-container">
            <input class="btn action-btn" type="submit" value="Submit" ng-click="submitReview()" ng-disabled="!newReview.valid" title="{{newReview.valid ? 'Submit your Review' : 'Your review is too short.'}}"/>
            <input class="btn action-btn" type="button" value="Discard" ng-click="discardReview()">
        </div>
    </div>
</div>

<loader data="mod.reviews" content-class="" spinner-class="big-spinner">
    <div ng-repeat="review in mod.reviews" class="content-block">
        <review review="review" show-author-column="true" index="100 + $index" user="user"></review>
    </div>

    <div class="no-content-message" ng-if="mod.reviews.length == 0">
        There are no reviews for this mod yet.
    </div>
</loader>