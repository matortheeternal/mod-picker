<two-columns>
    <loader data="mod" spinner-class="big-spinner">
        <div class="mod-header-color">
            <div class="page-container mod-header">
                <section>
                    <div class="quality-value action-box">
                        <span class="quality-number">{{mod.reputation | number:0}}</span>
                        REPUTATION
                    </div>

                    <div class="mod-info">
                        <span class="mod-name">{{mod.name}}</span>
                        <span class="mod-authors-container">by
                            <span class="mod-authors">{{mod.nexus_infos.authors}}</span>
                        </span>
                        <!--<span ng-repeat="author in mod.authors">
                            <a ng-href="#/user/{{author.id}}">{{author.username}}</a>
                        </span>-->
                        <br>
                        <!-- TODO: reviews currently are on tab 1 -> should be dynamic anyway -> ui-router :D -->
                        {{mod.reviews.length | number}} reviews
                        <!-- TODO: add this with css :after content -->
                        <span class="divider" ng-if="mod.aliases || permissions.canManage">
                            |
                        </span>

                        <!--Included in <a ng-href="#/modlists/includingMod/{{mod.id}}">{{mod.mod_modlists_count}} modlists</a>
                        <span class="divider">
                            |
                        </span>-->

                        <span ng-if="mod.aliases">
                            <strong>Aliases: </strong>{{mod.aliases}}
                            <span class="divider" ng-if="permissions.canManage">
                                |
                            </span>
                        </span>

                        <a ng-href="#/mod/{{mod.id}}/edit" ng-if="permissions.canManage">Edit</a>
                    </div>
                </section>

                <section>
                    <div class="mod-header-box">
                        <!-- TODO: I feel like using some spans here would be wiser -->
                        ACTIONS
                        <div class="action-box" ng-click="starMod()">
                            <i class="fa {{modStarred ? 'fa-star' : 'fa-star-o'}}" aria-hidden="true"></i>
                            {{modStarred ? 'Unfavorite' : 'Favorite'}}
                        </div>
                        <div class="action-box">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                            Add to mod list
                        </div>
                    </div>

                    <div class="mod-header-box">
                        STATUS
                        <div class="action-box {{statusClass}} capitalize">
                            {{mod.status}}
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <messages success-bool="showSuccess" errors="errors" success-message="{{submitMessage}}">
        </messages>

        <div class="page-container">
            <loader data="mod" spinner-class="big-spinner">
                <div class="left-column left-mod-column wide-column">

                    <!--Image-->
                    <img ng-src="{{mod.image}}" class="mod-image"/>

                    <!--Sources-->
                    <h3 class="section-title">Sources</h3>
                    <section class="sources">
                        <!-- TODO: I feel like this redundancy here can be killed with a directive -->
                        <a ng-if="mod.nexus_infos" ng-href="http://www.nexusmods.com/{{game.nexus_name}}/mods/{{mod.nexus_infos.id}}">
                            <div class="action-box source-box">
                                <img src="/assets/nexus_logo" class="source-image"/>
                                <span class="source-label">Nexus</span>
                            </div>
                        </a>
                        <a ng-if="mod.workshop_infos" ng-href="http://steamcommunity.com/sharedfiles/filedetails/{{mod.workshop_infos.id}}">
                            <div class="action-box source-box">
                                <img src="/assets/workshop_logo" class="source-image" />
                                <span class="source-label">Steam</span>
                            </div>
                        </a>
                        <a ng-if="mod.lover_infos" ng-href="http://www.loverslab.com/files/file/{{mod.lover_infos.id}}">
                            <div class="action-box source-box">
                                <img src="/assets/lab_logo" class="source-image" />
                                <span class="source-label">Lab</span>
                            </div>
                        </a>
                    </section>

                    <!--Requirements-->
                    <h3 ng-if="currentVersion.required_mods.length" class="section-title">Requirements</h3>
                    <section ng-if="currentVersion.required_mods.length">
                        <ol class="requirements-list">
                            <li ng-repeat="requirement in requirements">
                                <a ng-href="#/mod/{{requirement.id}}">
                                    <strong>{{requirement.name}}</strong>
                                </a>
                                <span ng-if="requirement.aliases">({{requirement.aliases}})</span>
                            </li>
                        </ol>
                    </section>

                    <!--Categories-->
                    <!-- TODO: one line if for readability (even though I like the idea of this ;3 )-->
                    <h3 class="section-title">Categor<span ng-hide="secondCategory">y</span><span ng-show="secondCategory">ies</span></h3>
                    <section>
                        <div ng-show="mod.primary_category_id" class="action-box">{{primaryCategory.name}}</div>
                        <div ng-show="mod.secondary_category_id" class="action-box">{{secondaryCategory.name}}</div>
                    </section>

                    <!--Tags-->
                    <h3 class="section-title">Tags</h3>
                    <section>
                        <tag-selector active-tags="mod.tags" new-tags="newTags" max-tags="10" show-mods-count="true" show-add="true" can-create="permissions.canCreateTags" show-remove="permissions.canManage"></tag-selector>
                    </section>

                    <!--Site Stats-->
                    <!-- TODO: kill redundancy-->
                    <div class="stat-block" ng-if="mod.nexus_infos && mod.nexus_infos.has_stats">
                        <div class="stat-block-title" ng-click="nexusExpanded = !nexusExpanded">
                           <h3 class="section-title">Nexus Mods stats</h3>
                           <i class="fa fa-plus stat-expander" aria-hidden="true" ng-hide="nexusExpanded"></i>
                           <i class="fa fa-minus stat-expander" aria-hidden="true" ng-show="nexusExpanded"></i>
                        </div>
                        <section ng-show="nexusExpanded">
                            <nexus-stats></nexus-stats>
                        </section>
                    </div>
                    <div class="stat-block" ng-if="mod.workshop_infos && mod.workshop_infos.has_stats">
                        <div class="stat-block-title" ng-click="workshopExpanded = !workshopExpanded">
                           <h3 class="section-title">Steam Workshop stats</h3>
                           <i class="fa fa-plus stat-expander" aria-hidden="true" ng-hide="workshopExpanded"></i>
                           <i class="fa fa-minus stat-expander" aria-hidden="true" ng-show="workshopExpanded"></i>
                        </div>
                        <section ng-show="workshopExpanded">
                            <workshop-stats></workshop-stats>
                        </section>
                    </div>
                    <div class="stat-block" ng-if="mod.lover_infos && mod.lover_infos.has_stats">
                        <div class="stat-block-title" ng-click="labExpanded = !labExpanded">
                           <h3 class="section-title">Lover's Lab stats</h3>
                           <i class="fa fa-plus stat-expander" aria-hidden="true" ng-hide="labExpanded"></i>
                           <i class="fa fa-minus stat-expander" aria-hidden="true" ng-show="labExpanded"></i>
                        </div>
                        <section ng-show="labExpanded">
                            <lab-stats></lab-stats>
                        </section>
                    </div>

                </div>
                <div class="right-column tabs-column">
                    <tabs current-tab="currentTab" on-change="switchTab" tabs="tabs"></tabs>
                    <div ng-include="currentTab.url" class="mod-tab"></div>
                </div>
            </loader>
        </div>
    </loader>
</two-columns>
