<div class="modal-container" ng-click="unfocusImportModal($event)">
    <messages event="modalMessage"></messages>

    <div class="modal huge-modal">
        <form>
            <div class="close-modal">
                <span class="fa fa-times" ng-click="toggleImportModal()"></span>
            </div>

            <h2>Mod List Import</h2>

            <h3 class="section-title">Import Type</h3>
            <section class="center">
                <span class="import-type" ng-repeat="importType in importTypes" ng-class="{ 'selected' : importType.selected }" ng-click="selectImportType(importType)">
                    <div>
                        <img ng-if="importType.image" ng-src="{{::importType.image}}"/>
                        <i ng-if="importType.icon" class="fa {{::importType.icon}}"></i>
                    </div>
                    <span class="import-type-caption">{{::importType.name}}</span>
                </span>
            </section>

            <h3 class="section-title">Import Files</h3>
            <section>
                <div ng-show="selectedImportType.modListXml">
                    <span class="input-label">modlist.xml</span>
                    <input type="file" file-change="selectModListXml" accept=".xml"/>
                </div>
                <div ng-show="selectedImportType.modListTxt">
                    <span class="input-label">modlist.txt</span>
                    <input type="file" file-change="selectModListTxt" accept=".txt"/>
                </div>
                <div ng-show="selectedImportType.loadOrderTxt">
                    <span class="input-label">loadorder.txt</span>
                    <input type="file" file-change="selectLoadOrderTxt" accept=".txt"/>
                </div>
            </section>

            <loader data="!loading.importedMods" spinner-class="big-spinner" ng-if="!errors.importedMods"></loader>
            <div ng-if="importedMods">
                <h3 class="section-title">Imported Mods</h3>
                <section class="box-shadow">
                    <table class="browse-table">
                        <thead>
                        <tr>
                            <th ng-repeat="column in modColumns" ng-click="sortColumn(column, sort, sortedColumn)" class="{{column.class}}" title="{{column.title}}">
                                {{::column.label}}
                                <div class="sorting-options" ng-if="sort && !column.unsortable">
                                    <div class="sort-up" ng-class="{ 'active' : column.up }">
                                        <i class="fa fa-caret-up"></i>
                                    </div>
                                    <div class="sort-down" ng-class="{ 'active' : column.down }">
                                        <i class="fa fa-caret-down"></i>
                                    </div>
                                </div>
                            </th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="item in importedMods | orderBy:sort.column:(sort.direction === 'DESC')">
                            <td bindonce class="source-data-column">
                                <div bo-if="!!item.sourceData.nexus_info_id">
                                    <b>Nexus ID:</b>
                                    <a ng-href="https://www.nexusmods.com/{{::gameName}}/mods/{{::item.sourceData.nexus_info_id}}" target="_blank">{{::item.sourceData.nexus_info_id}}</a>
                                </div>
                                <div bo-if="!!item.sourceData.mod_name">
                                    <b>Mod Name:</b> {{::item.sourceData.mod_name}}
                                </div>
                                <div bo-if="!!item.sourceData.plugin_filename">
                                    <b>Plugin Filename:</b> {{::item.sourceData.plugin_filename}}
                                </div>
                            </td>
                            <td class="mod-search-column">
                                <search-input search-function="searchMods" result-id="item.id" search-text="item.name" label="mod" key="name" ng-if="!item.custom"></search-input>
                                <input type="text" placeholder="Custom mod name" ng-model="item.name" ng-if="item.custom" pu-elastic-input/>
                            </td>
                            <td>
                                <label class="manage-item">
                                    <input type="checkbox" ng-model="item.custom"/>
                                </label>
                            </td>
                            <td>
                                <actions></actions>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </section>
            </div>

            <loader data="!loading.importedPlugins" spinner-class="big-spinner" ng-if="!errors.importedPlugins"></loader>
            <div ng-if="importedPlugins">
                <h3 class="section-title">Imported Plugins</h3>
                <section class="box-shadow">
                    <table class="browse-table">
                        <thead>
                        <tr>
                            <th ng-repeat="column in pluginColumns" ng-click="sortColumn(column, sort, sortedColumn)" class="{{column.class}}" title="{{column.title}}">
                                {{::column.label}}
                                <div class="sorting-options" ng-if="sort && !column.unsortable">
                                    <div class="sort-up" ng-class="{ 'active' : column.up }">
                                        <i class="fa fa-caret-up"></i>
                                    </div>
                                    <div class="sort-down" ng-class="{ 'active' : column.down }">
                                        <i class="fa fa-caret-down"></i>
                                    </div>
                                </div>
                            </th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="item in importedPlugins | orderBy:sort.column:(sort.direction === 'DESC')">
                            <td bindonce class="mod-search-column">
                                {{::item.filename}}
                            </td>
                            <td class="mod-search-column">
                                <a ng-href="#/mods/{{::item.mod_id}}" ng-if="item.mod_id && !item.custom">{{::item.mod_name}}</a>
                                <span ng-show="!item.mod_id || item.custom">-</span>
                            </td>
                            <td>
                                <label class="manage-item">
                                    <input type="checkbox" ng-model="item.custom" ng-disabled="!item.mod_id"/>
                                </label>
                            </td>
                            <td>
                                <actions></actions>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </section>
            </div>

            <div class="action-button-container">
                <input type="submit" class="btn action-btn" value="Import" ng-click="importModList()"/>
                <input type="submit" class="btn action-btn" value="Close" ng-click="toggleImportModal()"/>
            </div>
        </form>
    </div>
</div>