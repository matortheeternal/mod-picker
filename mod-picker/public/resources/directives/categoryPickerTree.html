<div ng-repeat="primaryCategory in categories">
    <expandable expanded="categoryFilter[primaryCategory.id].expanded" disable-style="true" disable-full-title-toggle="true" ng-show="primaryCategory.childs.length > 0">
        <expanded-title>
            <label class="supercategory">
                <input type="checkbox" ng-model="categoryFilter[primaryCategory.id].value" ng-indeterminate="categoryFilter[primaryCategory.id].indeterminate" ng-change="updateSelection(primaryCategory.id)"/>
                <span>{{primaryCategory.name}}</span>
            </label>
        </expanded-title>
        <content>
            <div class="sub-category" ng-repeat="secondaryCategory in primaryCategory.childs">
                <label>
                    <input type="checkbox" ng-model="categoryFilter[primaryCategory.id].childs[secondaryCategory.id].value" ng-change="updateSelection(primaryCategory.id, secondaryCategory.id)"/>
                    <span>{{secondaryCategory.name}}</span>
                </label>
            </div>
        </content>
    </expandable>
    <!-- not the best approach, not sure if there's a better way to do it -->
    <div ng-show="primaryCategory.childs.length == 0">
        <div class="expandable-title-container">
            <span class="no-icon"></span>
            <label class="supercategory">
                <input type="checkbox" ng-model="categoryFilter[primaryCategory.id].value" ng-indeterminate="categoryFilter[primaryCategory.id].indeterminate" ng-change="updateSelection(primaryCategory.id)"/>
                <span>{{primaryCategory.name}}</span>
            </label>
        </div>
    </div>
</div>