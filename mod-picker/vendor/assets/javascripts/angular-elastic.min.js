/*
 * angular-elastic v2.5.1
 * (c) 2014 Monospaced http://monospaced.com
 * License: MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="monospaced.elastic"),angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(a,b,c){"use strict";return{require:"ngModel",restrict:"A, C",link:function(d,e,f,g){function A(){var a=m;x=h,p=getComputedStyle(h),angular.forEach(z,function(b){a+=b+":"+p.getPropertyValue(b)+";"}),o.setAttribute("style",a)}function B(){var b,c,e,f,g;x!==h&&A(),y||(y=!0,o.value=h.value+k,o.style.overflowY=h.style.overflowY,b=""===h.style.height?"auto":parseInt(h.style.height,10),c=getComputedStyle(h).getPropertyValue("width"),"px"===c.substr(c.length-2,2)&&(f=parseInt(c,10)-s.width,o.style.width=f+"px"),e=o.scrollHeight,e>w?(e=w,g="scroll"):e<v&&(e=v),e+=s.height,h.style.overflowY=g||"hidden",b!==e&&(d.$emit("elastic:resize",i,b,e),h.style.height=e+"px"),a(function(){y=!1},1,!1))}function C(){y=!1,B()}var h=e[0],i=e;if("TEXTAREA"===h.nodeName&&b.getComputedStyle){i.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var j=h.value;h.value="",h.value=j;var x,y,k=f.msdElastic?f.msdElastic.replace(/\\n/g,"\n"):c.append,l=angular.element(b),m="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",n=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+m+'"/>').data("elastic",!0),o=n[0],p=getComputedStyle(h),q=p.getPropertyValue("resize"),r="border-box"===p.getPropertyValue("box-sizing")||"border-box"===p.getPropertyValue("-moz-box-sizing")||"border-box"===p.getPropertyValue("-webkit-box-sizing"),s=r?{width:parseInt(p.getPropertyValue("border-right-width"),10)+parseInt(p.getPropertyValue("padding-right"),10)+parseInt(p.getPropertyValue("padding-left"),10)+parseInt(p.getPropertyValue("border-left-width"),10),height:parseInt(p.getPropertyValue("border-top-width"),10)+parseInt(p.getPropertyValue("padding-top"),10)+parseInt(p.getPropertyValue("padding-bottom"),10)+parseInt(p.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},t=parseInt(p.getPropertyValue("min-height"),10),u=parseInt(p.getPropertyValue("height"),10),v=Math.max(t,u)-s.height,w=parseInt(p.getPropertyValue("max-height"),10),z=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];i.data("elastic")||(w=w&&w>0?w:9e4,o.parentNode!==document.body&&angular.element(document.body).append(o),i.css({resize:"none"===q||"vertical"===q?"none":"horizontal"}).data("elastic",!0),h.oninput="onpropertychange"in h&&"oninput"in h?h.onkeyup=B:B,l.bind("resize",C),d.$watch(function(){return g.$modelValue},function(a){C()}),d.$on("elastic:adjust",function(){A(),C()}),a(B,0,!1),d.$on("$destroy",function(){n.remove(),l.unbind("resize",C)}))}}}}]);